$(window).on("load", function () {

    // Perfect Scrollbar
    new PerfectScrollbar("#recent-buyers, #new-orders", { wheelPropagation: true });

    // Morris Bar (O'quv data asosida)
    Morris.Bar.prototype.fillForSeries = function (e) {
        return "0-#fff-#f00:20-#000";
    };
    Morris.Bar({
        element: "monthly-sales",
        data: (function () {
            var months = window.chartData.months;
            var data = window.chartData.data_2; // O'quv
            return months.map(function (m, i) {
                return { month: m, sales: data[i] };
            });
        })(),
        xkey: "month",
        ykeys: ["sales"],
        labels: ["Sales"],
        barGap: 4,
        barSizeRatio: 0.3,
        gridTextColor: "#bfbfbf",
        gridLineColor: "#E4E7ED",
        numLines: 5,
        gridtextSize: 14,
        resize: true,
        barColors: ["#FF394F"],
        hideHover: "auto"
    });

    // -------- Chartist Line Charts --------
    var drawChart = function (id, seriesData) {
        new Chartist.Line("#" + id, {
            labels: window.chartData.months, // X-axis
            series: [seriesData]             // Y-axis
        }, {
            lineSmooth: Chartist.Interpolation.simple({ divisor: 2 }),
            fullWidth: true,
            chartPadding: { right: 25 },
            axisX: { showGrid: false },
            axisY: {
                labelInterpolationFnc: function (value) {
                    return value >= 1000 ? (value / 1000) + "K" : value;
                },
                scaleMinSpace: 40
            },
            plugins: [Chartist.plugins.tooltip()],
            low: 0,
            showPoint: true,
            height: 300
        });
    };

    // Tablar uchun Chart draw funksiyasi
    var renderTabChart = function (e) {
        var activeTab = e || $("#ecommerceChartView .chart-action").find(".active");
        switch (activeTab.attr("href")) {
            case "#scoreLineToDay":   // Ilmiy
                drawChart("scoreLineToDay", window.chartData.data_1);
                break;
            case "#scoreLineToWeek":  // O'quv
                drawChart("scoreLineToWeek", window.chartData.data_2);
                break;
        }
    };

    // Sahifa yuklanganda default chart
    renderTabChart();

    // Tab click event
    $(".chart-action li a").on("click", function () {
        renderTabChart($(this));
    });

});
